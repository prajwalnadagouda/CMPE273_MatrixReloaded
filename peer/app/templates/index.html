<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>Matrix Reloaded</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <!-- Favicons -->
    <link
      href="{{ url_for('static', filename='assets/img/favicon.png') }}"
      rel="icon"
    />
    <link
      href="{{ url_for('static', filename='assets/img/apple-touch-icon.png') }}"
      rel="apple-touch-icon"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet"
    />

    <!-- Vendor CSS Files -->
    <link
      href="{{ url_for('static', filename='assets/vendor/animate.css/animate.min.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='assets/vendor/aos/aos.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='assets/vendor/bootstrap/css/bootstrap.min.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='assets/vendor/bootstrap-icons/bootstrap-icons.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='assets/vendor/boxicons/css/boxicons.min.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='assets/vendor/glightbox/css/glightbox.min.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='assets/vendor/remixicon/remixicon.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='assets/vendor/swiper/swiper-bundle.min.css') }}"
      rel="stylesheet"
    />

    <!-- Template Main CSS File -->
    <link
      href="{{ url_for('static', filename='assets/css/style.css') }}"
      rel="stylesheet"
    />

    <!-- =======================================================
  * Template Name: Selecao - v4.9.1
  * Template URL: https://bootstrapmade.com/selecao-bootstrap-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  </head>

  <body>
    <!-- ======= Header ======= -->
    <header id="header" class="d-flex align-items-center">
      <div class="container d-flex align-items-center justify-content-between">
        <div class="logo">
          <h1><a href="index.html">Matrix Reloaded</a></h1>

          <!-- Uncomment below if you prefer to use an image logo -->
          <!-- <a href="index.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->
        </div>
      </div>
    </header>
    <!-- End Header -->

    <!-- ======= Hero Section ======= -->
    <section
      id="hero"
      class="d-flex flex-column justify-content-end align-items-center"
    >
      <div
        id="heroCarousel"
        data-bs-interval="5000"
        class="container carousel carousel-fade"
        data-bs-ride="carousel"
      >
        <div class="carousel-item active">
          <section>
            <!-- <a href="#" class="logo"
          ><img alt="logo" src="assets/img/Matrix.png" height="150px"
        /></a> -->

            <form class="form">
              <div class="parent">
                <div class="child">
                  <label
                    for="matrix1"
                    style="color: white; font-family: Open Sans"
                    >First Matrix Elements</label
                  >
                  <br />
                  <textarea
                    style="border-radius: 10px"
                    id="matrix1"
                    type="text"
                    rows="4"
                    cols="50"
                    placeholder="Enter matrix as list of lists"
                  ></textarea>
                  <p
                    id="output1"
                    style="
                      color: rgb(114, 112, 112);
                      font-weight: 900;
                      align-items: center;
                      top: 370px;
                      right: 700px;
                      width: 400px;
                      height: 50px;
                    "
                  ></p>
                </div>
                <div class="child">
                  <label for="matrix2" style="color: white"
                    >Second Matrix Elements</label
                  >
                  <br />
                  <textarea
                    style="border-radius: 10px"
                    id="matrix2"
                    type="text"
                    rows="4"
                    cols="50"
                    placeholder="Enter matrix as list of lists"
                  ></textarea>
                  <p
                    id="output2"
                    style="
                      color: rgb(114, 112, 112);
                      font-weight: 900;
                      align-items: center;
                      top: 370px;
                      right: 220px;
                      width: 400px;
                      height: 50px;
                    "
                  ></p>
                </div>

                <!-- <p class="submit"> -->
                <div style="align-items: center">
                  <!-- <div> -->

                  <!-- </div> -->

                  <input
                    class="button-89"
                    value="Submit"
                    role="button"
                    type="button"
                    onclick="validate()"
                  />
                  <input
                    class="button-89"
                    value="Clear"
                    role="button"
                    type="button"
                    onclick="clears()"
                  />
                </div>
                <br />
                <br />
                <!-- </div> -->

                <div id="results" style="display: none">
                  <label
                    for="result"
                    style="
                      color: white;
                      font-family: Open Sans;
                      font-weight: bold;
                    "
                    >Result</label
                  >
                  <br />
                  <div class="copy-area">
                    <textarea
                      id="inner"
                      style="border-radius: 10px"
                      readonly
                      id="result"
                      type="text"
                      rows="4"
                      cols="80"
                    ></textarea>
                    <div class="input-edit" style="display: inline-block">
                      <button type="button" onclick="copy()">
                        <span id="copy-btn"> Copy </span>
                      </button>
                    </div>
                    <div class="input-edits" style="display: inline-block">
                      <button id="down" type="button" onclick="downlaod()">
                        <span id="copy-btns"> Download </span>
                      </button>
                    </div>
                  </div>
                  <br />
                  <br />
                  <br />
                  <br />

                  <br />
                  <br />
                  <br />
                  <br />

                  <div style="font-weight: 900">
                    <p id="inner_1"></p>
                    <p id="inner_2"></p>
                  </div>
                </div>
              </div>
            </form>
          </section>
        </div>
      </div>
      <div></div>
      <svg
        class="hero-waves"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        viewBox="0 24 150 28 "
        preserveAspectRatio="none"
      >
        <defs>
          <path
            id="wave-path"
            d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"
          ></path>
        </defs>
        <g class="wave1">
          <use
            xlink:href="#wave-path"
            x="50"
            y="3"
            fill="rgba(255,255,255, .1)"
          ></use>
        </g>
        <g class="wave2">
          <use
            xlink:href="#wave-path"
            x="50"
            y="0"
            fill="rgba(255,255,255, .2)"
          ></use>
        </g>
        <g class="wave3">
          <use xlink:href="#wave-path" x="50" y="9" fill="#fff"></use>
        </g>
      </svg>
    </section>

    <!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer">
      <div class="container">
        <h3>Matrix Reloaded</h3>
        <!-- <p>Et aut eum quis fuga eos sunt ipsa nihil. Labore corporis magni eligendi fuga maxime saepe commodi placeat.</p> -->
        <div class="social-links">
          <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
          <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
          <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
          <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
          <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
        </div>
        <div class="copyright">
          &copy; Copyright <strong><span>Matrix</span></strong
          >. All Rights Reserved
        </div>
        <div class="credits">
          <!-- All the links in the footer should remain intact. -->
          <!-- You can delete the links only if you purchased the pro version. -->
          <!-- Licensing information: https://bootstrapmade.com/license/ -->
          <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/selecao-bootstrap-template/ -->
          Designed by <a href="">us</a>
        </div>
      </div>
    </footer>
    <!-- End Footer -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <!-- Vendor JS Files -->

    <!-- Template Main JS File -->
    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-1.7.1.min.js"
    ></script>

    <script>
      var name = "{{ name }}";
      function getFormattedTime() {
        var today = new Date();
        var y = today.getFullYear();
        var m = today.getMonth() + 1;
        var d = today.getDate();
        var h = today.getHours();
        var mi = today.getMinutes();
        var s = today.getSeconds();
        return y + "-" + m + "-" + d + "-" + h + "-" + mi + "-" + s;
      }
      function download(file, text) {
        var element = document.createElement("a");
        element.setAttribute(
          "href",
          "data:text/plain;charset=utf-8, " + encodeURIComponent(text)
        );
        element.setAttribute("download", file);
        document.body.appendChild(element);
        element.click();

        document.body.removeChild(element);
      }
      document.getElementById("down").addEventListener(
        "click",
        function () {
          var text = document.getElementById("inner").value;
          var filename = "results_" + getFormattedTime() + ".txt";
          download(filename, text);
        },
        false
      );

      function copy() {
        let copyArea = document.querySelector(".copy-area");
        let text = document.getElementById("inner");
        text.select();
        document.execCommand("copy");
        document.getElementById("copy-btn").style.display = "none";
        copyArea.classList.add("active");
        window.getSelection(() => {
          document.getElementById("copy-btn").style.display = "block";
          copyArea.classList.remove("active");
        }, 2500);
      }
      function clears() {
        document.getElementById("matrix1").value = "";
        document.getElementById("matrix2").value = "";
        document.getElementById("output1").style.display = "none";
        document.getElementById("output2").style.display = "none";
        document.getElementById("results").style.display = "none";
      }
      function validate() {
        var xhr = new XMLHttpRequest();
        var url = "http://0.0.0.0:" + name + "/connected";
        // var url = "http://0.0.0.0:".{{name}}."/connected";
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            // print(xhr.responseText)
            var json = JSON.parse(xhr.responseText);
            console.log(json["ans"]);
            console.log(json["time_taken"]);
            document.getElementById("results").style.display = "block";
            var result_1 =
              "Time taken to calculate the result by distributing the load among peers:  " +
              json["time_taken"] +
              " sec";
            var result_2 =
              "Time taken to calculate the result by not distributing the load among peers:  " +
              json["time_taken_trad"] +
              " sec";
            document.getElementById("inner").innerHTML = json["ans"];
            document.getElementById("inner_1").innerHTML = result_1;
            document.getElementById("inner_2").innerHTML = result_2;
          }
        };
        // console.log("asa")
        var output1 = "";
        var output2 = "";
        document.getElementById("output1").innerHTML = output1;
        document.getElementById("output2").innerHTML = output2;
        document.getElementById("output1").style.display = "block";
        document.getElementById("output2").style.display = "block";
        var $firstMatrix = document.getElementById("matrix1").value;
        var $secondMatrix = document.getElementById("matrix2").value;
        if ($firstMatrix == "") {
          output1 = "First matrix elements can not be blank.";
        } else if ($secondMatrix == "") {
          output2 = "Second matrix elements can not be blank.";
        }
        if (output1 != "") {
          document.getElementById("output1").innerHTML = output1;
          return;
        } else if (output2 != "") {
          document.getElementById("output2").innerHTML = output2;
          return;
        }
        try {
          $firstMatrix = JSON.parse($firstMatrix);
        } catch {
          output1 =
            "First matrix does not have matching brackets or missing commas";
        }

        try {
          $secondMatrix = JSON.parse($secondMatrix);
        } catch {
          output2 =
            "Second matrix does not have matching brackets or missing commas";
        }
        if (output1 != "") {
          document.getElementById("output1").innerHTML = output1;
          return;
        } else if (output2 != "") {
          document.getElementById("output2").innerHTML = output2;
          return;
        }
        valid_one = $firstMatrix.every(
          (a) => Array.isArray(a) && a.every((item) => typeof item === "number")
        );
        valid_two = $secondMatrix.every(
          (a) => Array.isArray(a) && a.every((item) => typeof item === "number")
        );

        if (valid_one != true) {
          output1 = "First matrix is not a valid matrix fromart";
        }
        if (valid_two != true) {
          output2 = "Second matrix is not a valid matrix fromart";
        }
        if (output1 != "") {
          document.getElementById("output1").innerHTML = output1;
          return;
        } else if (output2 != "") {
          document.getElementById("output2").innerHTML = output2;
          return;
        }
        var rows_firstMatrix = $firstMatrix.length;
        var rows_seocndMatrix = $secondMatrix.length;
        var cols_firstMatrix = $firstMatrix[0].length;
        var cols_seocndMatrix = $secondMatrix[0].length;

        console.log(rows_firstMatrix, cols_seocndMatrix);
        if (rows_seocndMatrix != cols_firstMatrix) {
          output1 =
            "The matrices does not have format suitable to perform calculation";
          console.log(output1);
        }
        if (rows_firstMatrix != cols_seocndMatrix) {
          output2 =
            "The matrices does not have format suitable to perform calculation";
          console.log(output2);
        }
        if (output1 != "") {
          document.getElementById("output1").innerHTML = output1;
          // return;
        }
        if (output2 != "") {
          document.getElementById("output2").innerHTML = output2;
          // return;
        }
        if (output1 != "" || output2 != "") {
          return;
        }
        const same_rows_first = $firstMatrix.every(
          (x) => x.length === $firstMatrix[0].length
        );
        const same_rows_second = $secondMatrix.every(
          (x) => x.length === $secondMatrix[0].length
        );
        if (same_rows_first != true) {
          output1 = "First matrix does not have rows of same length";
        }
        if (same_rows_second != true) {
          output2 = "Second matrix does not have rows of same length";
        }
        if (output1 != "") {
          document.getElementById("output1").innerHTML = output1;
          return;
        } else if (output2 != "") {
          document.getElementById("output2").innerHTML = output2;
          return;
        }
        json_request = {
          firstMatrix: JSON.stringify($firstMatrix),
          secondMatrix: JSON.stringify($secondMatrix),
        };
        xhr.send(JSON.stringify(json_request));
      }
    </script>
  </body>
</html>
